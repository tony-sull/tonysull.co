---
import Layout from '@layouts/Page.astro'
import { fetchBookmark, fetchBookmarks } from '@data/bookmarks.js'
import BookmarkCard from '@components/BookmarkCard.astro'

export async function getStaticPaths() {
  const allBookmarks = await fetchBookmarks()

  return allBookmarks.map(({ slug }) => {
    return {
      params: { slug },
    }
  })
}

const { slug } = Astro.params as { slug: string }

const bookmark = await fetchBookmark(slug)

if (!bookmark) {
  throw new Error(`[fetchBookmark] how was "${slug}" not found?`)
}
---

<Layout
  title={bookmark.metadata.title}
  image={bookmark.metadata.image}
>
  <setion>
    <BookmarkCard {...bookmark} />
  </setion>
</Layout>
