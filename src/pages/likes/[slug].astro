---
import Layout from '@layouts/Page.astro'
import { fetchLike, fetchLikes } from '@data/likes.js'
import LikeCard from '@components/LikeCard.astro'

export async function getStaticPaths() {
  const allLikes = await fetchLikes()

  return allLikes.map(({ slug }) => {
    return {
      params: { slug },
    }
  })
}

const { slug } = Astro.params as { slug: string }

const like = await fetchLike(slug)

if (!like) {
  throw new Error(`[fetchLike] how was "${slug}" not found?`)
}
---

<Layout
  title={like.title}
  image={like.metadata.image}
>
  <setion>
    <LikeCard {...like} />
  </setion>
</Layout>
